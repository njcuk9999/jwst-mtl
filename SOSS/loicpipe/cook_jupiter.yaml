# ---------------------------------------------------------------------
# loic pipe test
# ---------------------------------------------------------------------

# ---------------------------------------------------------------------
# General data parameters
# ---------------------------------------------------------------------
general:
  debug: True

# -----------------------------------------------------------------------------
# data parameters
# -----------------------------------------------------------------------------
data:
  # raw data directory
  raw: /scratch3/jwst-soss/data/wasp107/raw
  # data string
  data_string: jw01201008001_04101_00001
  # files to use
  filelist:
    - jw01201008001_04101_00001-seg001_nis
    - jw01201008001_04101_00001-seg002_nis
    - jw01201008001_04101_00001-seg003_nis
    - jw01201008001_04101_00001-seg004_nis
  # crds directory
  crds-dir: /scratch3/jwst/pipeline/crds_cache/references/jwst/niriss
  # calibration directory
  calib-dir: /scratch3/jwst/pipeline/calib_dir
  # atoca reference file directory
  atoca-dir: /scratch3/jwst/pipeline/atoca_dir
  # set the ref trace table (must be in the atoca directory)
  ref_trace_table: SOSS_ref_trace_table_SUBSTRIP256.fits
  # custom dark - if subarray.name is in this we switch to it otherwise we
  #               use the default (these must be in the calib-dir)
  custom_dark:
    default: jwst_niriss_dark_loiccustom.fits
    SUBSTRIP96: jwst_niriss_dark_loiccustom_substrip96.fits
  # whether the custom dark has the super bias included
  custom_dark_has_superbias_included: True
  # superbias file (must be in the calib-dir directory)
  superbias: jwst_niriss_superbias_0181.fits
  # set the wave map (must be in the atoca directory)
  wave_map: SOSS_ref_2D_wave_SUBSTRIP256.fits
  # set the spec profile (must be in the atoca directory)
  spec_profile: SOSS_ref_2D_profile_SUBSTRIP256.fits
  # photom file (must be in the crds-dir)
  photom: jwst_niriss_photom_rev2.fits

# ---------------------------------------------------------------------
# Loicpipe parameters
# ---------------------------------------------------------------------
loicpipe:
  # whether to only to extraction (no previous steps in stage 1 + 2)
  extract_only: False
  # define the dq mask values
  dq_mask:
    - 0
    - 88
    - 1361
  # ---------------------------------------------------------------------------
  # Stage 1 parameters
  stage1:
    # whether to run loicpipe for stage 1
    run: True
    # whether to skip stacking
    skip_stack: False
    # saturation map file
    satmap: None
    # whether to erase / clean the saturation map files
    erase_clean_sat: False
    # whether we fit the ramp (if False uses last read)
    fit_ramp: True
  # ---------------------------------------------------------------------------
  # Stage 2 parameters
  stage2:
    # whether to run loicpipe for stage 2
    run: True
    # whether to run flat fielding
    flat_field: True
    # whether to erase / clean the rate int files
    erase_clean_rateints: False
    # whether to run custom outlier rejection
    custom_outlier_rejection: False
    # define custom outlier window size (rows and columns)
    custom_outlier_window:
      - 3
      - 11
    # define custom outlier n sigma for rejection
    custom_outlier_nsig: 3
    # erase / clean custom outlier files
    erase_clean_custom_outlier: False
    # define the aphalfwidth for background subtraction
    aphalfwidth:
      - 40
      - 20
      - 20
    # erase / clean background files
    erase_clean_background: False
    # whether to do the background subtraction
    background_subtract: True
    # background contamination mask (None for no mask)
    contam_mask: None
    # whether to do the bad pixel interpolation
    bad_pix_interp: True
    # whether to do a local background subtraction
    local_background_subtraction: False
    # define the local background subtraction width
    local_sub_width: 9
    # define the local background offset
    local_sub_back_offset: -25
    # whether to remove NaNs
    remove_nans: True
    # extraction method: atoca, optimal, box
    extraction_method: box
    # extraction box width (used in all three methods)
    extraction_box_width: 32
    # extraction soss transform [three integers]
    soss_transform:
      - 0
      - 0
      - 0
  # ---------------------------------------------------------------------------
  # Stage 3 parameters
  stage3:
    # whether to run loicpipe for stage 3
    run: False


# -----------------------------------------------------------------------------
# SupremeSpoon parameters
# ----------------------------------------------------------------------------
SupremeSpoon:
  # ---------------------------------------------------------------------------
  # Stage 1 parameters
  stage1:
    # whether to run SupremeSpoon for stage 1
    run: False
  # ---------------------------------------------------------------------------
  # Stage 2 parameters
  stage2:
    # whether to run SupremeSpoon for stage 2
    run: False
  # ---------------------------------------------------------------------------
  # Stage 2 parameters
  stage3:
    # whether to run SupremeSpoon for stage 2
    run: False
